<?php $__env->startSection('title', 'Appointments'); ?>
<?php $__env->startSection('header_css'); ?>
    <style>

        div.text-container {
            margin: 0 auto;
            width: 75%;
        }

        .text-content{
            line-height: 1em;
        }

        .short-text {
            overflow: hidden;
            height: 2em;
        }

        .full-text{
            height: auto;
        }

        h1 {
            font-size: 24px;
        }

        .show-more {
            padding: 10px 0;
            text-align: center;
        }

    </style>
<?php $__env->stopSection(); ?>
<?php $__env->startSection('main'); ?>

    <div class="container">
        <div class="block-header">
            <h2>Appointments</h2>
        </div>

        <div class="card">

            <ul class="nav nav-pills nav-justified">
                <li><a href="<?php echo e(route('admin.appointments.packages')); ?>">Confirmed</a></li>
                <li class="active"><a href="<?php echo e(route('admin.appointments.pending')); ?>">Pending</a></li>
            </ul>


            <div class="table-responsive">

                <table class="table table-striped">
                    <thead>
                    <tr>
                        <th>S N</th>
                        <th>Packages</th>
                        <th>Doctor</th>
                        <th>Date</th>
                        <th>Shift</th>
                        <th>Patient Name</th>
                        <th>Address</th>
                        <th>Mobile No.</th>
                        <th>Email Address</th>
                        <th>Message</th>
                        <th>Action</th>
                    </tr>
                    </thead>
                    <tbody>
                    <?php /**/$i=1/**/ ?>
                    <?php $__empty_1 = true; foreach($unconf_app as $app): $__empty_1 = false; ?>

                        <tr>
                            <td><?php echo e($i++); ?></td>
                            <td><?php echo e($app->package); ?></td>
                            <td><?php echo e($app->doctor); ?></td>
                            <td><?php echo e($app->date); ?></td>
                            <td><?php echo e($app->shift); ?></td>
                            <td><?php echo e($app->f_name); ?></td>
                            <td><?php echo e($app->address); ?></td>
                            <td><?php echo e($app->mobile); ?></td>
                            <td><?php echo e($app->email); ?></td>
                            <td>
                                <div class="text-container">
                                    <div class="text-content short-text">
                                        <?php echo $app->message; ?>

                                    </div>
                                    <div class="show-more">
                                        <a href="#">Show more</a>
                                    </div>
                                </div>
                            </td>



                            <td>

                                <?php if($app->is_confirmed == 1): ?>
                                    <a href="#" class="change-status btn btn-primary btn-icon waves-effect waves-circle waves-float waves-effect waves-circle waves-float" id="<?php echo $app->id; ?>"  data-toggle="tooltip" title="Change Status"><i
                                                class="zmdi zmdi-check-circle zmdi-hc-fw"></i></a>
                                <?php else: ?>
                                    <a href="#" class="change-status btn btn-primary btn-icon waves-effect waves-circle waves-float waves-effect waves-circle waves-float" id="<?php echo $app->id; ?>"  data-toggle="tooltip" title="Change Status"><i
                                                class="zmdi zmdi-lock zmdi-hc-fw"></i></a>
                                <?php endif; ?>

                            </td>
                        </tr>

                    <?php endforeach; if ($__empty_1): ?>
                        <tr>
                            <td colspan="7"><h5 style="text-align: center;">No bookings added yet.</h5></td>
                        </tr>
                    <?php endif; ?>
                    </tbody>
                </table>
                <?php echo $unconf_app->render(); ?>

            </div>
        </div>
    </div>
<?php $__env->stopSection(); ?>
<?php $__env->startSection('footer_js'); ?>
    <script>
        $(".show-more a").each(function() {
            var $link = $(this);
            var $content = $link.parent().prev("div.text-content");

            console.log($link);

            var visibleHeight = $content[0].clientHeight;
            var actualHide = $content[0].scrollHeight - 1;

            console.log(actualHide);
            console.log(visibleHeight);

            if (actualHide > visibleHeight) {
                $link.show();
            } else {
                $link.hide();
            }
        });

        $(".show-more a").on("click", function() {
            var $link = $(this);
            var $content = $link.parent().prev("div.text-content");
            var linkText = $link.text();

            $content.toggleClass("short-text, full-text");

            $link.text(getShowLinkText(linkText));

            return false;
        });

        function getShowLinkText(currentText) {
            var newText = '';

            if (currentText.toUpperCase() === "SHOW MORE") {
                newText = "Show less";
            } else {
                newText = "Show more";
            }

            return newText;
        }


    </script>

    <script type="text/javascript">

        $(document).ready(function () {

            $('.change-status').click(function (event) {
                event.preventDefault();
                $object = this;
                $.ajax({
                    type: 'POST',
                    url: '<?php echo e(route("admin.appointments.change_statusPackage")); ?>',
                    data: {id: $object.id, _token: '<?php echo csrf_token(); ?>'},
                    success: function (response) {
                        console.log(response);
                        if (response.is_confirmed == 1) {
                            $($object).html('<i class="zmdi zmdi-check-circle zmdi-hc-fw"></i>');
                        } else {
                            $($object).html('<i class="zmdi zmdi-lock zmdi-hc-fw"></i>');
                        }
                        swal({
                            title: "Success!",
                            text: response.message,
                            imageUrl: AdminAssetPath + "img/thumbs-up.png",
                            timer: 2000,
                            showConfirmButton: false
                        });
                    },
                    error: function (e) {
                        debugger;
                    },
                });
            });
        });

    </script>
<?php $__env->stopSection(); ?>
<?php echo $__env->make('admin.layout.app', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>