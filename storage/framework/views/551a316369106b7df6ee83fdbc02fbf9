<?php $__env->startSection('title', 'Doctors Management'); ?>
<?php $__env->startSection('main'); ?>

    <div class="container">
        <div class="block-header">
            <h2>Categories</h2>
        </div>
        <div class="card">
            <div class="card-header">
                <a href="<?php echo e(route('admin.news.addCategory')); ?>" class="btn btn-primary waves-effect">Add Category</a>
            </div>
            <?php if(Session::has('add_success')): ?>
                <div class="alert alert-success fade in">
                    <button type="button" class="close close-sm" data-dismiss="alert">
                        <i class="fa fa-times"></i>
                    </button>
                    <strong>Success!</strong> <?php echo e(Session::get('add_success')); ?>

                </div>
            <?php endif; ?>

            <?php if(Session::has('edit_success')): ?>
                <div class="alert alert-success fade in">
                    <button type="button" class="close close-sm" data-dismiss="alert">
                        <i class="fa fa-times"></i>
                    </button>
                    <strong>Success!</strong> <?php echo e(Session::get('edit_success')); ?>

                </div>
            <?php endif; ?>

            <?php if(Session::has('del_success')): ?>
                <div class="alert alert-success fade in">
                    <button type="button" class="close close-sm" data-dismiss="alert">
                        <i class="fa fa-times"></i>
                    </button>
                    <strong>Success!</strong> <?php echo e(Session::get('del_success')); ?>

                </div>
            <?php endif; ?>

            <?php if(Session::has('status_success')): ?>
                <div class="alert alert-success fade in">
                    <button type="button" class="close close-sm" data-dismiss="alert">
                        <i class="fa fa-times"></i>
                    </button>
                    <strong>Success!</strong> <?php echo e(Session::get('status_success')); ?>

                </div>
            <?php endif; ?>

            <?php if(Session::has('error')): ?>
                <div class="alert alert-danger fade in">
                    <button type="button" class="close close-sm" data-dismiss="alert">
                        <i class="fa fa-times"></i>
                    </button>
                    <strong>Warning!</strong> <?php echo e(Session::get('error')); ?>

                </div>
            <?php endif; ?>
            <div class="card-body table-responsive">
                <table class="table">
                    <thead>
                    <tr>
                        <th>S.N.</th>
                        <th>Title</th>
                        <th>Image</th>
                        <th>Status</th>
                        <th>Added On</th>
                        <th>Action</th>
                    </tr>
                    </thead>
                    <tbody>
                    <?php /**/$i=1/**/ ?>

                    <?php $__empty_1 = true; foreach($categories as $cat): $__empty_1 = false; ?>
                        <tr>
                            <td><?php echo e($i++); ?></td>
                            <td><?php echo e($cat->category); ?></td>
                            <td>
                                <?php if($cat->image): ?>
                                    <img src="<?php echo e(asset('uploads/news/'.$cat->image)); ?>" style="height: 90px; width: 160px;">
                                <?php endif; ?>
                            </td>
                            <td>
                                <?php if($cat->status=='active'): ?>
                                    <a class="label label-success">Published</a>
                                <?php else: ?>
                                    <a class="label label-danger">Unpublished</a>
                                <?php endif; ?>
                            </td>
                            <td><?php echo e(Carbon\Carbon::parse($cat->created_at)->toFormattedDateString()); ?></td>
                            <td>
                                <a href="<?php echo e(route('admin.news.editCategory',[$cat->id])); ?>" class="btn btn-primary btn-xs">Edit</a>
                                <?php if($cat->status=='active'): ?>
                                    <a href="<?php echo e(route('admin.news.changeCategoryStatus',[$cat->id,'not_active'])); ?>" class="btn btn-info btn-xs">Disable</a>
                                <?php else: ?>
                                    <a href="<?php echo e(route('admin.news.changeCategoryStatus',[$cat->id,'active'])); ?>" class="btn btn-info btn-xs">Enable</a>
                                <?php endif; ?>
                                <a href="javascript:void(0)" class="btn btn-danger btn-xs delete" data-id="<?php echo e($cat->id); ?>">Delete</a>
                            </td>
                        </tr>
                    <?php endforeach; if ($__empty_1): ?>
                        <tr>
                            <td>-</td>
                            <td>-</td>
                            <td>-</td>
                            <td>-</td>
                            <td>-</td>
                            <td>-</td>
                            <td>-</td>
                        </tr>
                    <?php endif; ?>
                    </tbody>
                </table>
                <div align="center">
                    <?php echo $categories->render(); ?>

                </div>
            </div>
        </div>
    </div>
<?php $__env->stopSection(); ?>
<?php $__env->startSection('footer_js'); ?>
    <script type="text/javascript">

        $(function(){
            $(".delete").click(function(){
                var id = $(this).data("id");
                var $tr = $(this).closest('tr')
                swal({
                        title: "Are you sure?",
                        text: "You will not be able to recover this news!",
                        type: "warning",
                        showCancelButton: true,
                        confirmButtonColor: "#DD6B55",
                        confirmButtonText: "Yes, delete it!",
                        closeOnConfirm: false
                    },
                    function(){
                        var url = "<?php echo e(url('admin/news/deleteCategory')); ?>/"+id;
                        $.ajax({
                            type: "GET",
                            url: url,
                            datatype: "json",
                            success: function(data){
                                var obj = jQuery.parseJSON(data);
                                if(obj.status == 'success'){
                                    swal("Deleted!", "Category has been deleted.", "success");
                                    $tr.find('td').fadeOut(1000,function(){
                                        $tr.remove();
                                    });
                                }
                            }
                        });
                    });
            });
        });

    </script>
<?php $__env->stopSection(); ?>

<?php echo $__env->make('admin.layout.app', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>